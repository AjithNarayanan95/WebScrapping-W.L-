<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P.E.T.e</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <style>
    body {
        background-image: url('{{ url_for('static', filename='5655049.jpg') }}');
        background-size: cover;
        background-repeat: no-repeat;
    }
    .container {
        padding: 20px;
        margin: 0 auto;
        width: 80%;
        background-color: rgba(255, 255, 255, 0.8);
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .nav-container {
        background-color: #334376;
        border-radius: 15px;
        padding: 10px;
        margin-bottom: 20px;
    }
    .nav-links {
        list-style-type: none;
        padding: 0;
        margin: 0;
        text-align: center;
    }
    .nav-links li {
        display: inline;
        margin-right: 20px;
    }
    .nav-links li a {
        color: #ffffff;
        text-decoration: none;
        font-size: 18px;
        font-weight: bold;
        padding: 10px;
    }
    .nav-links li a:hover {
        background-color: #0055cc;
        border-radius: 10px;
    }
    .scripts-container {
        background-color: #f1f9fd;
        padding: 20px;
        border-radius: 10px;
        color: #334376;
    }
    label {
        font-weight: bold;
        font-size: 20px;
        color: #334376;
        text-transform: capitalize;
    }
    .script-row {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }
    .script-container {
        display: flex;
        align-items: center;
        text-align: center;
        background-color: rgba(0, 138, 83, 0.25) !important;
        padding: 10px !important;
        gap: 10px;
        width: 30%;
        margin-bottom: 20px;
    }
    .button-container {
        margin-top: 20px;
        display: flex;
        justify-content: space-between;
    }
    .button {
        width: 250px;
        height: 35px;
        font-size: 16px;
        padding: 10px;
        border: none;
        border-radius: 25px;
        color: white;
    }
    .run-button {
        background-color: #15a65e;
    }
    .stop-button {
        background-color: grey;
    }
    .stop-button:disabled {
        background-color: grey;
    }
    input[type="checkbox"] {
        margin-left: 70px;
        width: 20px;
        height: 20px;
        transform: scale(.7);
        margin-right: 1px;
    }
    .schedule-section {
        background-color: rgba(4, 10, 122, 0.11);
        display: none;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
        color: #ffffff;
    }
    input[type="date"],
    input[type="time"] {
        width: 300px;
        height: 40px;
        font-size: 18px;
        padding: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
        margin-bottom: 10px;
    }
    .schedule-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
    }
    .schedule-buttons .button {
        width: 250px%;
        background-color: #15a65e
    }
    .toggle-button {
        background-color: #15a65e;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        font-size: 16px;
        margin-bottom: 20px;
    }
    .toggle-button.collapsed {
        background-color: #6c757d;
    }
    .scheduled-task {
        background-color: rgba(0, 138, 83, 0.25);
        padding: 10px;
        border-radius: 5px;
        margin-top: 20px;
    }
    .popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 400px;
        padding: 20px;
        background-color: white;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        border-radius: 10px;
    }
    .popup h3 {
        margin-top: 0;
    }
    .popup .form-group {
        margin-bottom: 15px;
    }
    .popup .form-group label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
    }
    .popup .form-group input[type="date"],
    .popup .form-group input[type="time"],
    .popup .form-group select {
        width: 100%;
        padding: 5px;
        font-size: 16px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }
    .popup .form-actions {
        text-align: right;
    }
    .popup .form-actions button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-size: 16px;
    }
    .popup .form-actions .cancel-button {
        background-color: grey;
        color: white;
        margin-right: 10px;
    }
    .popup .form-actions .save-button {
        background-color: #28a745;
        color: white;
    }
    .schedule-date-time {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }
    .schedule-date-time .form-group {
        flex: 1;
        min-width: 200px;
    }
    .schedule-date-time input,
    .schedule-date-time select {
        width: 100%;
        font-size: 16px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }
    .logo {
        width: 150px;
        height: auto;
        display: block;
    }
    .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
<!--        padding: 1px;-->
    }
    h1 {
        text-align: center;
        margin: 0;
        font-family: 'Anton';
    }
    .repeat-dropdown {
        width: 150px;
        height: 50px;
        font-size: 16px;
        padding: 5px 10px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }
    .repeat-dropdown::-ms-expand {
        display: none;
    }
    .repeat-dropdown:focus {
        outline: none;
        border-color: #007bff;
    }
    .repeat-dropdown {
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url("data:image/svg+xml;utf8,<svg fill='black' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/><path d='M0 0h24v24H0z' fill='none'/></svg>");
        background-repeat: no-repeat;
        background-position-x: calc(100% - 10px);
        background-position-y: 50%;
    }

    .digital-marketing-logo {
    width: 350px; /* Adjust this value as needed */
    height: 150px; /* Adjust this value as needed */
<!--    object-fit: contain; /* This ensures the image is scaled properly within the dimensions */-->
}
        .scripts-container {
    background-color: #f1f9fd;
    padding: 20px;
    border-radius: 10px;
    color: #334376;
    margin-bottom: 20px;
}

.schedule-content {

    padding: 20px;
    border-radius: 10px;
}

.schedule-date-time {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    margin-bottom: 20px;
}

.schedule-date-time .form-group {
    width: 30%;
    margin-bottom: 10px;
}

.schedule-date-time label {
    display: block;
    margin-bottom: 5px;
}

.schedule-date-time input,
.schedule-date-time select {
    width: 100%;
    padding: 5px;
    font-size: 16px;
    border-radius: 5px;
    border: 1px solid #ccc;
}

.schedule-buttons {
    display: flex;
    justify-content: space-between;
}

.schedule-buttons .button {

    height: 35px;
    font-size: 16px;
    padding: 5px;
    border: none;
    border-radius: 25px;
    color: white;
    background-color: #15a65e;
}

#toggle-schedule-button {
    margin-bottom: 20px;
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="{{ url_for('static', filename='Screenshot 2024-06-20 at 6.33.36â€¯PM.png') }}" alt="Logo" class="logo">
            <img src="{{ url_for('static', filename='Digital Marketing.png') }}" alt="Logo" class="logo digital-marketing-logo">
<!--            <h1>P.E.T.e</h1>-->
        </div>
        <div class="nav-container">
            <ul class="nav-links">
                <li><a href="/">Scrape Products</a></li>
                <li><a href="/settings">Settings</a></li>
            </ul>
        </div>
        <div class="scripts-container">
            <form id="script-form">
                <h2>Select Scripts to Run:</h2>
                <div class="script-row">
                    {% for script in scripts %}
                        <div class="script-container">
                            <input type="checkbox" id="{{ script }}" name="scripts" value="{{ script }}">
                            <label for="{{ script }}">{{ script[:-3]|capitalize }}</label>
                        </div>
                        {% if loop.index % 3 == 0 %}
                            </div>
                            <div class="script-row">
                        {% endif %}
                    {% endfor %}
                </div>
            </form>
        </div>

        <div class="button-container">
            <button id="run-button" class="button run-button" type="button">Run</button>
            <button id="stop-button" class="button stop-button" type="button" disabled>Stop</button>
        </div>
        <div id="scheduled-task-display" class="scheduled-task" style="display: none;">
            <h3>Scheduled Task</h3>
            <p id="scheduled-task-info"></p>
        </div>
        <button id="toggle-schedule-button" class="toggle-button collapsed" type="button">Show Schedule Options</button>
        <div class="scripts-container" id="schedule-section" style="display: none;">
    <h2>Schedule Scripts:</h2>
    <div class="schedule-content">
        <div class="schedule-date-time">
            <div class="form-group">
                <label for="start-date">Start Date:</label>
                <input type="date" id="start-date" name="start-date">
            </div>
            <div class="form-group">
                <label for="start-time">Start Time:</label>
                <input type="time" id="start-time" name="start-time">
            </div>
            <div class="form-group">
                <label for="recurrence-type">Repeat:</label>
                <select id="recurrence-type" name="recurrence-type" class="repeat-dropdown">
                    <option value="once">Once</option>
                    <option value="monthly">Monthly</option>
                </select>
            </div>
        </div>
        <div class="schedule-buttons">
            <button id="schedule-button" class="button" type="button">Schedule</button>
            <button id="stop-schedule-button" class="button" type="button">Stop Scheduling</button>
        </div>
    </div>
</div>
        <div id="consoles-container" class="scripts-container">
    <h2>Console Output:</h2>
    <div id="consoles"></div>
</div>
    </div>

    <script>
    document.getElementById('stop-button').addEventListener('click', function() {
    fetch('/stop_scripts', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({})
    }).then(response => response.json())
        .then(data => {
            console.log(data.status);
            document.getElementById('run-button').disabled = false;
            document.getElementById('stop-button').disabled = true;
            document.getElementById('schedule-button').disabled = false;
            document.getElementById('stop-schedule-button').disabled = true;
            updateButtonColors();
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.disabled = false;
            });
            saveState();

        }).catch(error => {
            console.error('Error stopping scripts:', error);
        });

});

    document.getElementById('run-button').addEventListener('click', function() {
    let formData = new FormData(document.getElementById('script-form'));

    fetch('/run_scripts', {
        method: 'POST',
        body: new URLSearchParams(formData)
    }).then(response => response.json())
        .then(data => {
            let selectedScripts = formData.getAll('scripts');
            let consolesDiv = document.getElementById('consoles');
            consolesDiv.innerHTML = '';
            selectedScripts.forEach(script => {
                let consoleDiv = document.createElement('div');
                consoleDiv.id = `console-${script}`;
                consoleDiv.className = 'console-box';
                consoleDiv.innerHTML = `<h3>${script}</h3><p>Status: Running</p><p>URLs Scraped: 0</p>`;
                consolesDiv.appendChild(consoleDiv);
            });
            updateStatus();
            document.getElementById('run-button').disabled = true;
            document.getElementById('stop-button').disabled = false;
            document.getElementById('schedule-button').disabled = true;
            document.getElementById('stop-schedule-button').disabled = true;
            updateButtonColors();
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.disabled = true;
            });
            saveState(); // Save state immediately after updating UI
        });
});

    document.getElementById('schedule-button').addEventListener('click', function() {
    let formData = new FormData(document.getElementById('script-form'));
    let checkedScripts = document.querySelectorAll('input[name="scripts"]:checked');

    if (checkedScripts.length > 0) {
        checkedScripts.forEach(script => {
            formData.append('scripts', script.value);
        });
        const startDate = document.getElementById('start-date').value;
        const startTime = document.getElementById('start-time').value;
        const recurrenceType = document.getElementById('recurrence-type').value;

        formData.append('start-date', startDate);
        formData.append('start-time', startTime);
        formData.append('recurrence-type', recurrenceType);

        fetch('/schedule_scripts', {
            method: 'POST',
            body: formData
        }).then(response => response.json())
        .then(data => {
            if (data.status.startsWith('Scheduled')) {
                displayScheduledTask(data.status);
                document.getElementById('run-button').disabled = true;
                document.getElementById('run-button').style.backgroundColor = 'grey';
                document.getElementById('stop-button').disabled = true;
                document.getElementById('schedule-button').disabled = true;
                document.getElementById('stop-schedule-button').disabled = false;
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.disabled = true;
            });
                updateButtonColors();
                saveState();
                window.stop_execution = false;
            } else {
                console.error('Scheduling error:', data.status);
                alert('Error scheduling script: ' + data.status);
            }
        }).catch(error => {
            console.error('Error scheduling script:', error);
            alert('An error occurred while scheduling the script. Please try again.');
        });
    } else {
        alert('Please select a script to schedule.');
    }
    saveState();
});

    document.getElementById('toggle-schedule-button').addEventListener('click', function() {
    const scheduleSection = document.getElementById('schedule-section');
    const toggleButton = document.getElementById('toggle-schedule-button');

    if (scheduleSection.style.display === 'none') {
        scheduleSection.style.display = 'block';
        toggleButton.textContent = 'Hide Schedule Options';
        toggleButton.classList.remove('collapsed');
    } else {
        scheduleSection.style.display = 'none';
        toggleButton.textContent = 'Show Schedule Options';
        toggleButton.classList.add('collapsed');
    }
});



    function displayScheduledTask(status) {
        let scheduledTaskInfo = document.getElementById('scheduled-task-info');
        scheduledTaskInfo.textContent = `Scheduled Task: ${status}`;
        document.getElementById('scheduled-task-display').style.display = 'block';
        document.getElementById('run-button').disabled = true;
    }

    function updateStatus() {
        fetch('/status')
            .then(response => response.json())
            .then(data => {
                let consolesDiv = document.getElementById('consoles');
                Object.keys(data).forEach(scriptName => {
                    let consoleDiv = document.getElementById(`console-${scriptName}`);
                    if (consoleDiv) {
                        consoleDiv.innerHTML = `<h3>${scriptName}</h3><p>Status: ${data[scriptName]}</p>`;
                    } else {
                        consoleDiv = document.createElement('div');
                        consoleDiv.id = `console-${scriptName}`;
                        consoleDiv.className = 'console-box';
                        consoleDiv.innerHTML = `<h3>${scriptName}</h3><p>Status: ${data[scriptName]}</p>`;
                        consolesDiv.appendChild(consoleDiv);
                    }
                    saveState();
                });
                setTimeout(updateStatus, 1000);
            });
    }

    updateStatus();

    document.getElementById('stop-schedule-button').addEventListener('click', function() {
    fetch('/stop_all', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({})
    })
    .then(response => response.json())
    .then(data => {
        console.log(data.status);
        document.getElementById('scheduled-task-info').textContent = '';
        document.getElementById('scheduled-task-display').style.display = 'none';
<!--        document.getElementById('run-button').disabled = false;-->
<!--        document.getElementById('stop-button').disabled = true;-->
<!--        document.getElementById('schedule-button').disabled = false;-->
<!--        document.getElementById('stop-schedule-button').disabled = true;-->
            pollStatus();
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.disabled = false;
        });
        updateButtonColors();
        saveState();
        alert('All scheduled tasks and running scripts have been stopped.');
    })
    .catch(error => {
        console.error('Error stopping all tasks and scripts:', error);
        alert('An error occurred while stopping tasks and scripts. Please try again.');
    });
});

function pollStatus() {
    fetch('/status')
        .then(response => response.json())
        .then(data => {
            const anyRunning = Object.values(data).some(status => status === 'Running' || status === 'Stopping');
            if (!anyRunning) {
                document.getElementById('run-button').disabled = false;
                document.getElementById('stop-button').disabled = true;
                document.getElementById('schedule-button').disabled = false;
                document.getElementById('stop-schedule-button').disabled = true;
                updateButtonColors();
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.disabled = false;
                });
                saveState();
            } else {
                // Continue polling if any scripts are still running
                setTimeout(pollStatus, 1000);
            }
        })
        .catch(error => {
            console.error('Error polling status:', error);
        });
}
<!--    function saveState() {-->
<!--    const checkboxes = document.querySelectorAll('input[type="checkbox"]');-->
<!--    const state = {-->
<!--        checkboxes: Array.from(checkboxes).map(cb => ({ id: cb.id, checked: cb.checked })),-->
<!--        runButtonDisabled: document.getElementById('run-button').disabled,-->
<!--        stopButtonDisabled: document.getElementById('stop-button').disabled,-->
<!--        startDate: document.getElementById('start-date').value,-->
<!--        startTime: document.getElementById('start-time').value,-->
<!--        recurrenceType: document.getElementById('recurrence-type').value-->
<!--    };-->
<!--    localStorage.setItem('pageState', JSON.stringify(state));-->
<!--}-->

function saveState() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    const state = {
        checkboxes: Array.from(document.querySelectorAll('input[type="checkbox"]')).map(cb => ({ id: cb.id, checked: cb.checked })),
        runButtonDisabled: document.getElementById('run-button').disabled,
        stopButtonDisabled: document.getElementById('stop-button').disabled,
        scheduleButtonDisabled: document.getElementById('schedule-button').disabled,
        stopScheduleButtonDisabled: document.getElementById('stop-schedule-button').disabled,
        startDate: document.getElementById('start-date').value,
        startTime: document.getElementById('start-time').value,
        recurrenceType: document.getElementById('recurrence-type').value,
        scheduledTaskDisplay: document.getElementById('scheduled-task-display').style.display,
        scheduledTaskInfo: document.getElementById('scheduled-task-info').textContent
    };
    localStorage.setItem('pageState', JSON.stringify(state));
}

<!--function loadState() {-->
<!--    const savedState = localStorage.getItem('pageState');-->
<!--    if (savedState) {-->
<!--        const state = JSON.parse(savedState);-->

<!--        // Restore checkboxes-->
<!--        state.checkboxes.forEach(cb => {-->
<!--            const checkbox = document.getElementById(cb.id);-->
<!--            if (checkbox) checkbox.checked = cb.checked;-->
<!--        });-->

<!--        // Restore button states-->
<!--        document.getElementById('run-button').disabled = state.runButtonDisabled;-->
<!--        document.getElementById('stop-button').disabled = state.stopButtonDisabled;-->

<!--        // Restore scheduled task display-->
<!--        document.getElementById('scheduled-task-display').style.display = state.scheduledTaskDisplay;-->
<!--        document.getElementById('scheduled-task-info').textContent = state.scheduledTaskInfo;-->

<!--        // Restore schedule inputs-->
<!--        document.getElementById('start-date').value = state.startDate;-->
<!--        document.getElementById('start-time').value = state.startTime;-->
<!--        document.getElementById('recurrence-type').value = state.recurrenceType;-->

<!--        // Update button colors-->
<!--        updateButtonColors();-->
<!--    }-->
<!--}-->

<!--function loadState() {-->
<!--    return new Promise((resolve, reject) => {-->
<!--        const savedState = localStorage.getItem('pageState');-->
<!--        if (savedState) {-->
<!--            const state = JSON.parse(savedState);-->

<!--            // Restore checkboxes-->
<!--            state.checkboxes.forEach(cb => {-->
<!--                const checkbox = document.getElementById(cb.id);-->
<!--                if (checkbox) checkbox.checked = cb.checked;-->
<!--            });-->

<!--            // Restore schedule inputs-->
<!--            document.getElementById('start-date').value = state.startDate;-->
<!--            document.getElementById('start-time').value = state.startTime;-->
<!--            document.getElementById('recurrence-type').value = state.recurrenceType;-->
<!--        }-->

<!--        // Fetch current scheduling status from server-->
<!--        fetch('/get_scheduling_status')-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--                if (data.status === 'Scheduled') {-->
<!--                    let tasksInfo = data.tasks.map(task =>-->
<!--                        `${task.script_name} scheduled for ${task.run_date} at ${task.run_time} (${task.status})`-->
<!--                    ).join(', ');-->
<!--                    document.getElementById('scheduled-task-info').textContent = tasksInfo;-->
<!--                    document.getElementById('scheduled-task-display').style.display = 'block';-->
<!--                    document.getElementById('run-button').disabled = data.any_running;-->
<!--                    document.getElementById('stop-button').disabled = !data.any_running;-->
<!--                } else {-->
<!--                    document.getElementById('scheduled-task-display').style.display = 'none';-->
<!--                    document.getElementById('run-button').disabled = false;-->
<!--                    document.getElementById('stop-button').disabled = true;-->
<!--                }-->
<!--                updateButtonColors();-->
<!--                resolve();-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error('Error fetching scheduling status:', error);-->
<!--                // If there's an error, assume no tasks are scheduled-->
<!--                document.getElementById('scheduled-task-display').style.display = 'none';-->
<!--                document.getElementById('run-button').disabled = false;-->
<!--                document.getElementById('stop-button').disabled = true;-->
<!--                updateButtonColors();-->
<!--                reject(error);-->
<!--            });-->
<!--    });-->
<!--}-->

function loadState() {
    return new Promise((resolve, reject) => {
        const savedState = localStorage.getItem('pageState');
        if (savedState) {
            const state = JSON.parse(savedState);

            // Restore checkboxes and other inputs
            state.checkboxes.forEach(cb => {
                const checkbox = document.getElementById(cb.id);
                if (checkbox) checkbox.checked = cb.checked;
            });
            document.getElementById('start-date').value = state.startDate;
            document.getElementById('start-time').value = state.startTime;
            document.getElementById('recurrence-type').value = state.recurrenceType;

            // Restore button states
            document.getElementById('run-button').disabled = state.runButtonDisabled;
            document.getElementById('stop-button').disabled = state.stopButtonDisabled;
            document.getElementById('schedule-button').disabled = state.scheduleButtonDisabled;
            document.getElementById('stop-schedule-button').disabled = state.stopScheduleButtonDisabled;

            // Restore scheduled task display
            document.getElementById('scheduled-task-display').style.display = state.scheduledTaskDisplay;
            document.getElementById('scheduled-task-info').textContent = state.scheduledTaskInfo;
        }

        // Check server status to ensure UI is in sync
        fetch('/check_running_scripts')
            .then(response => response.json())
            .then(runningData => {
                if (runningData.any_running) {
                    document.getElementById('run-button').disabled = true;
                    document.getElementById('stop-button').disabled = false;
                    document.getElementById('schedule-button').disabled = true;
                    document.getElementById('stop-schedule-button').disabled = true;
                } else {
                    return fetch('/get_scheduling_status');
                }
            })
            .then(response => response ? response.json() : null)
            .then(data => {
                if (data && data.any_scheduled) {
                    let tasksInfo = data.tasks.map(task =>
                        `${task.script_name} scheduled for ${task.run_date} at ${task.run_time} (${task.status})`
                    ).join(', ');
                    document.getElementById('scheduled-task-info').textContent = tasksInfo;
                    document.getElementById('scheduled-task-display').style.display = 'block';
                    document.getElementById('run-button').disabled = true;
                    document.getElementById('stop-button').disabled = true;
                    document.getElementById('schedule-button').disabled = true;
                    document.getElementById('stop-schedule-button').disabled = false;
                }
                updateButtonColors();
                resolve();
            })
            .catch(error => {
                console.error('Error checking script status:', error);
                reject(error);
            });
    });
}



<!--function updateButtonColors() {-->
<!--    const runButton = document.getElementById('run-button');-->
<!--    const stopButton = document.getElementById('stop-button');-->

<!--    runButton.style.backgroundColor = runButton.disabled ? 'grey' : '#28a745';-->
<!--    stopButton.style.backgroundColor = stopButton.disabled ? 'grey' : '#dc3545';-->
<!--}-->

function updateButtonColors() {
    const buttons = ['run-button', 'stop-button', 'schedule-button', 'stop-schedule-button'];
    buttons.forEach(buttonId => {
        const button = document.getElementById(buttonId);
        button.style.backgroundColor = button.disabled ? 'grey' : '#15a65e';
    });
}

    function setDefaultDateTime() {
        const now = new Date();

        // Set default date
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, '0');
        const day = now.getDate().toString().padStart(2, '0');
        document.getElementById('start-date').value = `${year}-${month}-${day}`;

        // Set default time
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        document.getElementById('start-time').value = `${hours}:${minutes}`;
    }

window.addEventListener('DOMContentLoaded', function() {
    loadState().then(() => {
        const scheduleSection = document.getElementById('schedule-section');
        const toggleButton = document.getElementById('toggle-schedule-button');

        scheduleSection.style.display = 'none';
        toggleButton.textContent = 'Show Schedule Options';
        toggleButton.classList.add('collapsed');
    }).catch(error => {
        console.error('Error loading state:', error);
    });
});

    // Call the function when the page loads
<!--    window.addEventListener('DOMContentLoaded', setDefaultDateTime);-->

    </script>
</body>
</html>